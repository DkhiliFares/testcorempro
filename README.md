# âš¡ IAR Map Analyzer â€” STM32 Benchmarking Tool

A Python GUI application that parses **IAR EWARM linker `.map` files**, extracts total and per-function memory footprint (Flash / RAM), and exports detailed results to **Excel** â€” designed for benchmarking STM32 against competitor MCUs.

---

## ğŸ¯ Purpose

When comparing microcontrollers, understanding the memory footprint of firmware is critical. This tool automates the extraction of:

- **Total Flash usage** (read-only code + read-only data)
- **Total RAM usage** (read-write data)
- **Per-module breakdown** (which driver/library consumes the most memory)
- **Per-function breakdown** (individual function sizes, sorted by impact)

Results are exported to a styled **Excel workbook** for easy side-by-side comparison across different MCU platforms.

---

## ğŸ“¸ Features

| Feature | Description |
|---------|-------------|
| ğŸ“‚ **Map File Loader** | Browse and load any IAR EWARM `.map` file |
| ğŸ“Š **Summary Dashboard** | Cards showing RO Code, RO Data, RW Data, Total Flash, Total RAM |
| ğŸ“¦ **Module Breakdown** | Per-module memory usage with group classification and % of Flash |
| ğŸ”§ **Function Breakdown** | Per-function sizes, types (Code/Data), scope, and source object |
| ğŸ“‘ **Excel Export** | 3-sheet styled `.xlsx` workbook with auto-filters and conditional formatting |
| ğŸ¨ **Dark Modern UI** | Professional dark-themed interface built with tkinter |

---

## ğŸš€ Getting Started

### Prerequisites

- **Python 3.7+**
- **openpyxl** (for Excel export)

### Installation

```bash
pip install openpyxl
```

### Running the Tool

```bash
python map_analyzer.py
```

---

## ğŸ“– Usage

1. **Launch** the application
2. **Click** `ğŸ“‚ Browse Map File` â†’ select your `.map` file (generated by IAR EWARM linker)
3. **(Optional)** Enter the **MCU name** in the MCU field (e.g., `STM32F429`, `STM32L476`)
4. **View** the results:
   - **Summary cards** at the top show total memory footprint
   - **Module Breakdown** tab shows per-module usage
   - **Function Breakdown** tab shows per-function usage sorted by size
5. **Click** `ğŸ“Š Export to Excel` to save a detailed `.xlsx` report

---

## ğŸ“‘ Excel Export Format

The exported workbook contains 3 sheets:

| Sheet | Content |
|-------|---------|
| **Summary** | Project name, MCU, toolchain info, total Flash/RAM |
| **Module Breakdown** | Module name, group, RO Code, RO Data, RW Data, Total, % of Flash |
| **Function Breakdown** | Function name, address, size (bytes), type, scope, source object |

- Headers are styled with dark fills and white text
- Alternating row colors for readability
- Functions â‰¥ 200 bytes are highlighted in red
- Auto-filters enabled on all data columns

---

## ğŸ”§ Supported Map File Format

This tool parses **IAR EWARM linker** `.map` files (tested with IAR ELF Linker V9.70+). It extracts data from:

- `MODULE SUMMARY` section â€” per-module `ro code`, `ro data`, `rw data`
- `ENTRY LIST` section â€” per-function address, size, type
- Final summary â€” total readonly code, readonly data, readwrite data

> **Note:** The tool handles IAR's number formatting with `'` as thousands separator (e.g., `10'751`).

---

## ğŸ“ Project Structure

```
PFA/
â”œâ”€â”€ map_analyzer.py          # Main application (parser + GUI + Excel export)
â”œâ”€â”€ README.md                # This file
â””â”€â”€ keypad4x4/
    â””â”€â”€ EWARM/
        â””â”€â”€ keypad4x4/
            â””â”€â”€ List/
                â””â”€â”€ keypad4x4.map   # Example map file
```

---

## ğŸ§ª Verified With

| Map File | RO Code | RO Data | RW Data | Modules | Entries |
|----------|---------|---------|---------|---------|---------|
| `keypad4x4.map` | 10,751 B | 143 B | 1,264 B | 52 | 61 |

---

## ğŸ“ License

This project is developed for the PFA (Projet de Fin d'AnnÃ©e) benchmarking study.
